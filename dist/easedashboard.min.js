var app=angular.module("EASEDashboard",["ui.router","backand","EASEDashboard.services","EASEDashboard.controllers","angular-cache"]);app.config(function($stateProvider,$urlRouterProvider){$stateProvider.state("loading",{url:"/loading",templateUrl:"templates/loading-screen.php",controller:"loadingCtrl as loadingCtrl"}).state("tasks",{url:"/tasks/:taskstatus",templateUrl:"templates/task/view-task.php",controller:"TaskCtrl as TaskCtrl"}).state("task",{url:"/task/:taskid",templateUrl:"templates/task/info-task.php",controller:"singleTaskCtrl as TaskCtrl"}).state("mytasks",{url:"/mytasks/:taskstatus",templateUrl:"templates/task/my-task.php",controller:"TaskCtrl as TaskCtrl"}).state("mytask",{url:"/mytask/:taskid",templateUrl:"templates/task/myinfo-task.php",controller:"singleTaskCtrl as TaskCtrl"}).state("employee-add",{url:"/employee/add",templateUrl:"templates/employee/employee-add.php",controller:"employeeCtrl as employeeCtrl"}).state("employee-list",{url:"/employee/list",templateUrl:"templates/employee/employee-list.php",controller:"employeeCtrl as employeeCtrl"}),$urlRouterProvider.otherwise("/loading")}),app.config(function(BackandProvider){BackandProvider.setAppName("easetechnologysolutionsapp"),BackandProvider.setSignUpToken("bffe4f31-4066-4c49-9008-f967d436e3ce"),BackandProvider.setAnonymousToken("ec74fd01-4e6c-4444-bec6-9627ea4b17db")}),angular.module("EASEDashboard.controllers",["angular-cache","ngAnimate","ui.bootstrap"]).controller("TaskCtrl",function(Backand,$state,$scope,$rootScope,TaskService,$stateParams,$interval,cacheService){function getAllTask(){TaskCtrl.taskstatus=$stateParams.taskstatus,console.log($state.params.taskstatus),"mytasks"===$state.current.name?void 0!==TaskCtrl.myinfo?TaskService.getMyTask(TaskCtrl.myinfo.ease_id,$state.params.taskstatus).then(function(response){TaskCtrl.taskdata=response.data,TaskCtrl.loading="Daniel Gerald Gabriel"},function(){}):TaskService.getMyTask(TaskCtrl.userinfo.user_id).then(function(response){TaskCtrl.taskdata=response.data,TaskCtrl.loading="Daniel Gerald Gabriel"},function(){}):TaskService.getAllTask(TaskCtrl.taskstatus).then(function(response){TaskCtrl.taskdata=response.data,TaskCtrl.loading="Daniel Gerald Gabriel"},function(){})}function cutString(length,string){return string.substring(0,length)+"..."}function parseStatus(status){return"onHold"===status?"On Hold":"inProgress"===status?"In Progress":status}function getInfo(userinfo){console.log("getInfo : "+userinfo),TaskCtrl.myinfo=cacheService.getCachedInfo(userinfo),getAllTask()}var TaskCtrl=$scope;TaskCtrl.selectedPriority=void 0,$rootScope.singletaskinfo=void 0,TaskCtrl.loading=void 0,"mytasks"!==$state.current.name&&getAllTask(),angular.isDefined($rootScope.startGetAllTask)||($rootScope.startGetAllTask=$interval(function(){getAllTask(),console.log("getalltask")},5e3)),TaskCtrl.getInfo=getInfo,TaskCtrl.parseStatus=parseStatus,TaskCtrl.getAllTask=getAllTask,TaskCtrl.cutString=cutString}).controller("singleTaskCtrl",function(Backand,$state,$scope,$rootScope,singleTaskService,employeeService,$stateParams,$interval,CacheFactory,cacheService){function setTaskPriority(taskPriority){switch(taskPriority){case"Low":TaskCtrl.taskPriority=TaskCtrl.prioritySelectValue[0];break;case"Medium":TaskCtrl.taskPriority=TaskCtrl.prioritySelectValue[1];break;case"High":TaskCtrl.taskPriority=TaskCtrl.prioritySelectValue[2]}}function setTaskStatus(taskStatus){switch(taskStatus){case"Created":TaskCtrl.taskStatus=TaskCtrl.statusSelectValue[0];break;case"inProgress":TaskCtrl.taskStatus=TaskCtrl.statusSelectValue[1];break;case"Completed":TaskCtrl.taskStatus=TaskCtrl.statusSelectValue[2];break;case"onHold":TaskCtrl.taskStatus=TaskCtrl.statusSelectValue[3];break;case"Cancelled":TaskCtrl.taskStatus=TaskCtrl.statusSelectValue[4]}}function setTaskTags(taskTags){switch(taskTags){case"Web Design and Development":TaskCtrl.taskTags=TaskCtrl.tagsSelectValue[0];break;case"Graphic Design":TaskCtrl.taskTags=TaskCtrl.tagsSelectValue[1];break;case"Content Writing":TaskCtrl.taskTags=TaskCtrl.tagsSelectValue[2];break;case"SEO":TaskCtrl.taskTags=TaskCtrl.tagsSelectValue[3];break;case"Back Office Support":TaskCtrl.taskTags=TaskCtrl.tagsSelectValue[4];break;case"Help Desk Services":TaskCtrl.taskTags=TaskCtrl.tagsSelectValue[5]}}function getSingleTaskinfo(){singleTaskService.getTaskinfo($state.params.taskid).then(function(response){$rootScope.taskdataloading="Daniel Gerald Gabriel",$rootScope.singletaskinfo=response.data[0],console.log($rootScope.singletaskinfo),console.log($rootScope.singletaskinfo.ease_assignee),setTaskPriority($rootScope.singletaskinfo.task_priority),setTaskStatus($rootScope.singletaskinfo.task_status),setTaskTags($rootScope.singletaskinfo.task_tags),TaskCtrl.taskName=$rootScope.singletaskinfo.task_name,TaskCtrl.taskDescription=$rootScope.singletaskinfo.task_description,TaskCtrl.taskStart=parseDate($rootScope.singletaskinfo.task_start),TaskCtrl.taskDue=parseDate($rootScope.singletaskinfo.task_due)},function(){}),employeeService.getAll().then(function(response){var empData=response.data;TaskCtrl.empData=empData.data,console.log(TaskCtrl.empData);for(var i=0;i<TaskCtrl.empData.length;i++)console.log(TaskCtrl.empData[i].ease_id+" "+TaskCtrl.myinfo.ease_id),TaskCtrl.myinfo.ease_id===TaskCtrl.empData[i].ease_id&&(console.log("Match "+$rootScope.singletaskinfo.ease_assignee),TaskCtrl.taskAssignee=TaskCtrl.empData[i])},function(error){})}function getInfo(userinfo){console.log("getInfo : "+userinfo),TaskCtrl.myinfo=cacheService.getCachedInfo(userinfo)}function parseStatus(status){return"onHold"===status?"On Hold":"inProgress"===status?"In Progress":status}function parseDate(string){if(void 0!==string){var parsedString=string.split("T");return parsedString[0]}}function parseAssignee(Assignee){return null==Assignee?"None":Assignee}function updateTaskInfo(){$rootScope.taskdataloading=void 0,singleTaskService.updateTaskInfo($state.params.taskid,TaskCtrl.taskName,TaskCtrl.taskDescription,TaskCtrl.taskStart,TaskCtrl.taskDue,TaskCtrl.taskTags.name,TaskCtrl.taskAssignee.ease_id,TaskCtrl.taskPriority.name,TaskCtrl.taskStatus.value).then(function(){$interval(function(){$rootScope.taskdataloading="Daniel Gerald Gabriel"},3e3),console.log("success"),getSingleTaskinfo()},function(){})}var TaskCtrl=$scope;$interval.cancel($rootScope.startGetAllTask),$rootScope.taskdataloading=void 0;TaskCtrl.getInfo=getInfo,getSingleTaskinfo(),TaskCtrl.open2=function(){$scope.popup2.opened=!0},TaskCtrl.popup2={opened:!1},TaskCtrl.prioritySelectValue=[{name:"Low"},{name:"Medium"},{name:"High"}],TaskCtrl.statusSelectValue=[{value:"Created",name:"Created"},{value:"inProgress",name:"In Progress"},{value:"Completed",name:"Completed"},{value:"onHold",name:"On Hold"},{value:"Cancelled",name:"Cancelled"}],TaskCtrl.tagsSelectValue=[{name:"Web Design and Development"},{name:"Graphic Design"},{name:"Content Writing"},{name:"SEO"},{name:"Back Office Support"},{name:"Help Desk Services"}],TaskCtrl.updateTaskInfo=updateTaskInfo,TaskCtrl.parseAssignee=parseAssignee,TaskCtrl.parseDate=parseDate,TaskCtrl.parseStatus=parseStatus}).controller("employeeCtrl",function(Backand,$state,$scope,$rootScope,employeeService,$stateParams,$interval,$uibModal){function addEmployee(){employeeCtrl.loading="Daniel",employeeService.add(employeeCtrl.emp.nickname,employeeCtrl.emp.firstname,employeeCtrl.emp.middlename,employeeCtrl.emp.lastname,employeeCtrl.emp.address,employeeCtrl.emp.email,employeeCtrl.emp.mobile,employeeCtrl.emp.username,employeeCtrl.emp.password).then(function(){console.log("Registration Success"),$interval(function(){employeeCtrl.loading=void 0},3e3),$scope.message="Registration Successfull",modalOpen("sm","modal-success")},function(error){$scope.message="Registration Failed : Check network then try again",$interval(function(){employeeCtrl.loading=void 0},3e3),modalOpen("sm","modal-danger")}),console.log("addemployee"),console.log(employeeCtrl.emp.firstname)}function listAllEmployee(){employeeService.getAll().then(function(response){console.log("success"),employeeCtrl.allEmployees=response.data,console.log(employeeCtrl.allEmployees),employeeCtrl.loading="Daniel Gerald Gabriel"},function(error){console.log(error)})}function modalOpen(size,mclass){$uibModal.open({animation:!0,windowClass:mclass,templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",size:size,resolve:{items:function(){return $scope.message}}})}console.log($state);var employeeCtrl=$scope;console.log("empController loaded"),employeeCtrl.loading=void 0,"employee-list"===$state.current.name&&(listAllEmployee(),console.log("ListAll function")),$scope.message="<strong>Test</strong>",employeeCtrl.listAllEmployee=listAllEmployee,employeeCtrl.addEmployee=addEmployee,employeeCtrl.modalOpen=modalOpen}).controller("loadingCtrl",function($scope,$rootScope,$state,CacheFactory,cacheService){function getInfo(userinfo){var userinfos=cacheService.getCachedInfo(userinfo);switch(console.log(userinfos.ease_id),parseInt(userinfos.ease_role)){case 0:$state.go("tasks",{taskstatus:"All"});break;case 1:$state.go("tasks",{taskstatus:"All"});break;case 2:$state.go("tasks",{taskstatus:"All"});break;case 3:$state.go("mytasks",{taskstatus:"All"})}}var loadingCtrl=$scope;loadingCtrl.getInfo=getInfo}).controller("myTaskCtrl",function($scope,$rootScope,$state){}),angular.module("EASEDashboard.controllers").controller("ModalInstanceCtrl",function($scope,$uibModalInstance,items){$scope.message=items,console.log($scope.message),$scope.ok=function(){$uibModalInstance.close()},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("EASEDashboard.services",["angular-cache"]).service("TaskService",function($http,Backand){var TaskService=this;TaskService.getAllTask=function(taskcategory){return $http("All"===taskcategory?{method:"GET",url:Backand.getApiUrl()+"/1/query/data/getTaskAdmin",params:{parameters:{}}}:{method:"GET",url:Backand.getApiUrl()+"/1/query/data/getTaskWithFilter",params:{parameters:{status:taskcategory}}})},TaskService.getMyTask=function(ease_assignee,task_status){return console.log("task_status : "+task_status),$http("All"===task_status?{method:"GET",url:Backand.getApiUrl()+"/1/query/data/getMyTaskWithFilter",params:{parameters:{task_assignee:ease_assignee}}}:{method:"GET",url:Backand.getApiUrl()+"/1/query/data/getMyTask",params:{parameters:{task_status:task_status,task_assignee:ease_assignee}}})}}).service("singleTaskService",function($http,Backand){var singleTaskService=this;singleTaskService.getTaskinfo=function(id){return $http({method:"GET",url:Backand.getApiUrl()+"/1/query/data/getTaskInfo",params:{parameters:{id:id}}})},singleTaskService.updateTaskInfo=function(task_id,task_name,task_description,task_start,task_due,task_tags,task_assignee,task_priority,task_status){return $http({method:"PUT",url:Backand.getApiUrl()+"/1/objects/wp_easetasks/"+task_id+"?returnObject=true",data:{task_name:task_name,task_description:task_description,task_start:task_start,task_due:task_due,task_tags:task_tags,task_assignee:task_assignee,task_priority:task_priority,task_status:task_status}})}}).service("cacheService",function(CacheFactory){var cacheService=this;cacheService.getCachedInfo=function(userinfo){return userinfo}}).service("employeeService",function($http,Backand){var employeeService=this;employeeService.add=function(nickname,firstname,middlename,lastname,address,email,mobile,username,password){return $http({method:"GET",url:Backand.getApiUrl()+"/1/query/data/addEmployee",params:{parameters:{nickname:nickname,firstname:firstname,middlename:middlename,lastname:lastname,address:address,email:email,mobile:mobile,username:username,password:password}}})},employeeService.getAll=function(){return $http({method:"GET",url:Backand.getApiUrl()+"/1/objects/wp_easewebuser",params:{pageSize:20,pageNumber:1,filter:[{fieldName:"ease_role",operator:"greaterThan",value:"0"}],sort:""}})}});